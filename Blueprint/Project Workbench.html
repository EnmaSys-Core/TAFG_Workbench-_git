<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAFG v2: Project Workbench</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Load Tailwind Typography for P2 -->
    <script src="https://cdn.tailwindcss.com/3.4.1?plugins=typography"></script>
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Custom checkbox style */
        .task-checkbox {
            appearance: none;
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            min-width: 20px;
            background-color: #374151; /* gray-700 */
            border: 2px solid #4b5563; /* gray-600 */
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease-in-out;
            margin-right: 12px;
        }
        .task-checkbox:checked {
            background-color: #34d399; /* emerald-400 */
            border-color: #10b981; /* emerald-600 */
        }
        .task-checkbox:checked::after {
            content: 'âœ”';
            font-size: 14px;
            font-weight: 900;
            color: #064e3b; /* emerald-900 */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .task-label {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .task-checkbox:checked + .task-label {
            opacity: 0.5;
            text-decoration: line-through;
        }
        
        /* Progress bar animation */
        .progress-bar-inner {
            transition: width 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Active tab style */
        .tab-btn.active {
            background-color: #4f46e5; /* indigo-600 */
            color: #ffffff;
        }
        .tab-btn {
            transition: all 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 h-full flex flex-col">

    <!-- Header & Navigation -->
    <header class="bg-gray-800 shadow-lg sticky top-0 z-10">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-2xl font-bold text-white mb-4 sm:mb-0">
                TAFG v2: Project Workbench
            </h1>
            <!-- Tab buttons -->
            <div class="flex space-x-2 bg-gray-700 p-1 rounded-lg">
                <button id="btn-p1" class="tab-btn active text-sm sm:text-base font-medium py-2 px-3 sm:px-5 rounded-md">
                    ðŸš€ Gamified Plan
                </button>
                <button id="btn-p2" class="tab-btn text-sm sm:text-base font-medium py-2 px-3 sm:px-5 rounded-md text-gray-300 hover:bg-gray-600 hover:text-white">
                    ðŸ“„ Blueprint Text
                </button>
            </div>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- === PAGE 1: GAMIFIED PLAN === -->
        <div id="page1" class="space-y-8">
            
            <!-- Overall Progress -->
            <section class="bg-gray-800 p-6 rounded-xl shadow-2xl">
                <h2 class="text-xl font-semibold text-white mb-4">Overall Project Progress</h2>
                <div class="w-full bg-gray-700 rounded-full h-4 overflow-hidden">
                    <div id="progress-bar" class="progress-bar-inner bg-emerald-500 h-4 rounded-full" style="width: 0%"></div>
                </div>
                <p id="progress-text" class="text-right text-sm text-gray-400 mt-2">0 / 0 tasks complete</p>
            </section>

            <!-- Task List -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

                <!-- Column 1 -->
                <div class="space-y-8">
                    <!-- Section 1: Core Setup -->
                    <section class="bg-gray-800 p-6 rounded-xl shadow-2xl">
                        <h3 class="text-lg font-semibold text-white mb-5 border-b border-gray-700 pb-2">
                            Phase 1: Core Setup (Firebase)
                        </h3>
                        <ul class="space-y-4 task-list">
                            <li><label class="flex items-center"><input type="checkbox" id="task-fb-1" class="task-checkbox"><span class="task-label">Create Firebase Project</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-fb-2" class="task-checkbox"><span class="task-label">Add Web App & Get Config</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-fb-3" class="task-checkbox"><span class="task-label">Enable Google Authentication</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-fb-4" class="task-checkbox"><span class="task-label">Enable Firestore Database</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-fb-5" class="task-checkbox"><span class="task-label">Set Security Rules (Production Mode)</span></label></li>
                        </ul>
                    </section>

                    <!-- Section 2: App Modules (Part 1) -->
                    <section class="bg-gray-800 p-6 rounded-xl shadow-2xl">
                        <h3 class="text-lg font-semibold text-white mb-5 border-b border-gray-700 pb-2">
                            Phase 2: Application Modules
                        </h3>
                        <ul class="space-y-4 task-list">
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-0" class="task-checkbox"><span class="task-label">Build Global UI Shell (Tabs, Header)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-1" class="task-checkbox"><span class="task-label">Module 1: Authentication (UI & Logic)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-2" class="task-checkbox"><span class="task-label">Module 2: "Comprehend" (Goals UI & Logic)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-3-p1" class="task-checkbox"><span class="task-label">Module 3: "Deconstruct" (Bricks UI & Logic)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-3-p2" class="task-checkbox"><span class="task-label">Module 3: "Deconstruct" (Brain Dump UI & Logic)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-4" class="task-checkbox"><span class="task-label">Module 4: "Reconstruct" (Log UI & Logic)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-mod-5" class="task-checkbox"><span class="task-label">Module 5: "Two-Front War" (Energy UI & Chart)</span></label></li>
                        </ul>
                    </section>
                </div>
                
                <!-- Column 2 -->
                <div class="space-y-8">
                    <!-- Section 3: Global Requirements -->
                    <section class="bg-gray-800 p-6 rounded-xl shadow-2xl">
                        <h3 class="text-lg font-semibold text-white mb-5 border-b border-gray-700 pb-2">
                            Phase 3: Robustness & UI/UX
                        </h3>
                        <ul class="space-y-4 task-list">
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-1" class="task-checkbox"><span class="task-label">Implement Empty States</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-2" class="task-checkbox"><span class="task-label">Implement CRUD for Goals & Bricks</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-3" class="task-checkbox"><span class="task-label">Implement Soft Delete & "Undo" Toast</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-4" class="task-checkbox"><span class="task-label">Implement Loading States (Spinners)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-5" class="task-checkbox"><span class="task-label">Implement Success Messages (Toasts)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-ux-6" class="task-checkbox"><span class="task-label">Implement Friendly Error Handling</span></label></li>
                        </ul>
                    </section>

                    <!-- Section 4: Future Roadmap (as checklist) -->
                    <section class="bg-gray-800 p-6 rounded-xl shadow-2xl">
                        <h3 class="text-lg font-semibold text-white mb-5 border-b border-gray-700 pb-2">
                            Future Roadmap (v3 Plan)
                        </h3>
                        <p class="text-sm text-gray-400 mb-4">These are not part of v2, but good to track!</p>
                        <ul class="space-y-4 task-list">
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-0" class="task-checkbox"><span class="task-label">v3.0: Project Sharing ("Friends List")</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-1" class="task-checkbox"><span class="task-label">v3.1: Advanced Statistics</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-2" class="task-checkbox"><span class="task-label">v3.2: PWA (Progressive Web App)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-3" class="task-checkbox"><span class="task-label">v3.3: Framework Migration (e.g., Next.js)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-4" class="task-checkbox"><span class="task-label">v3.4: "Trash Can" (Recovery)</span></label></li>
                            <li><label class="flex items-center"><input type="checkbox" id="task-v3-5" class="task-checkbox"><span class="task-label">v3.5: "Daily Log / Mood Journal"</span></label></li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>

        <!-- === PAGE 2: BLUEPRINT TEXT === -->
        <div id="page2" class="hidden">
            <!-- Tailwind's `prose` class auto-formats the HTML inside -->
            <article class="prose prose-invert lg:prose-xl max-w-none prose-pre:bg-gray-800 prose-pre:text-gray-200 prose-code:text-emerald-400 prose-headings:text-white prose-a:text-indigo-400">
                
                <h1>TAFG v2: The Alchemist's Workbench â€” Project Blueprint</h1>
                <p><strong>Version:</strong> 1.2 | <strong>Date:</strong> October 25, 2025</p>

                <hr>

                <h2>1. Project Mission &amp; Philosophy</h2>
                <h3>ðŸŽ¯ Mission</h3>
                <p>Create a single-page web application as a persistent, personal "workbench" based on "The Alchemist's Field Guide" (TAFG).</p>
                
                <h3>ðŸ’¡ Philosophy</h3>
                <h4>1.5 Global UI/UX &amp; Robustness Requirements</h4>
                <p>Features required across all modules for usability:</p>
                <ul>
                    <li><strong>Empty States:</strong> Graceful handling for first-time users. All lists (Goals, Bricks) display a helpful message (e.g., <blockquote>"You have no Goals yet. Create your first one in the 'Comprehend' tab!"</blockquote>)</li>
                    <li><strong>CRUD Operations:</strong> Users can Create, Read, Update (Edit), and Delete their own Goals and Bricks.</li>
                    <li><strong>Soft Delete &amp; Undo:</strong> Deleting sets a flag (<code>isDeleted: true</code>). A "toast" notification appears for 5â€“10 seconds with an "Undo" button.</li>
                    <li><strong>User Feedback:</strong> Clear, non-technical feedback throughout.</li>
                    <li><strong>Loading States:</strong> Show a spinner when fetching or saving data.</li>
                    <li><strong>Success Messages:</strong> Brief confirmation (e.g., <blockquote>"Brick saved!"</blockquote>)</li>
                    <li><strong>Error Handling:</strong> Friendly message if save fails (e.g., <blockquote>"Could not save. Please check your connection."</blockquote>)</li>
                </ul>

                <hr>

                <h2>2. Technology Stack (The "How")</h2>
                <p>This project is a single HTML file using a Backend-as-a-Service (BaaS) for data and authentication.</p>
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Technology</th>
                                <th>Choice &amp; (Pros/Cons)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Frontend File</td>
                                <td>HTML</td>
                                <td><code>TAFG_v2.html</code> (single file)</td>
                            </tr>
                            <tr>
                                <td>Styling</td>
                                <td>CSS</td>
                                <td>Tailwind CSS (CDN) â€” Rapid, modern UI; CDN load</td>
                            </tr>
                            <tr>
                                <td>App Logic</td>
                                <td>JavaScript</td>
                                <td>Vanilla JS (ES6+) â€” No build step, fast, all-in-one-file; code can get large</td>
                            </tr>
                            <tr>
                                <td>Charts</td>
                                <td>JS Library</td>
                                <td>Chart.js (CDN) â€” Excellent for "Energy Log" chart</td>
                            </tr>
                            <tr>
                                <td>Database</td>
                                <td>BaaS</td>
                                <td>Google Firestore â€” Real-time, generous free plan, auto-scaling; requires setup</td>
                            </tr>
                            <tr>
                                <td>Authentication</td>
                                <td>BaaS</td>
                                <td>Google Firebase Auth â€” Secure, easy "Sign in with Google," user management</td>
                            </tr>
                            <tr>
                                <td>Hosting</td>
                                <td>Static Host</td>
                                <td>Vercel or GitHub Pages â€” Free, fast, integrates with GitHub repo</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <hr>

                <h2>3. Core Setup: Firebase (The Critical Path)</h2>
                <p>One-time setup steps:</p>
                <ol>
                    <li><strong>Create Project:</strong> Firebase Console â†’ New project (e.g., "Alchemist Workbench")</li>
                    <li><strong>Add Web App:</strong> Dashboard â†’ <code>&lt;/&gt;</code> icon â†’ Add "Web App"</li>
                    <li><strong>Get Config:</strong> Copy <code>firebaseConfig</code> object for use in <code>TAFG_v2.html</code></li>
                    <li><strong>Enable Authentication:</strong> Build â†’ Authentication â†’ Sign-in method â†’ Enable Google provider</li>
                    <li><strong>Enable Database:</strong> Build â†’ Firestore Database â†’ Create database (start in "production mode")</li>
                    <li><strong>Set Security Rules:</strong> Firestore â†’ Rules tab â†’ Paste the following (ESSENTIAL for privacy):</li>
                </ol>
                <pre><code class="language-js">rules_version = '2';
service cloud.firestore {
    match /databases/{database}/documents {
        // Allow users to read/write *only* their own documents in each collection
        match /goals/{docId} {
            allow read, write, delete: if request.auth != null &amp;&amp; request.auth.uid == resource.data.userId;
        }
        match /bricks/{docId} {
            allow read, write, delete: if request.auth != null &amp;&amp; request.auth.uid == resource.data.userId;
        }
        match /notes/{goalId} {
            // notes docId will BE the goalId
            allow read, write, delete: if request.auth != null &amp;&amp; request.auth.uid == resource.data.userId;
        }
        match /energyLog/{docId} {
            allow read, write, delete: if request.auth != null &amp;&amp; request.auth.uid == resource.data.userId;
        }
        // Add rules for new collections from v1.2 blueprint
        match /dailyLog/{docId} {
            allow read, write, delete: if request.auth != null &amp;&amp; request.auth.uid == resource.data.userId;
        }

        // Allow users to *create* new documents, but only if they set the userId to their own
        match /goals/{docId} {
            allow create: if request.auth != null &amp;&amp; request.resource.data.userId == request.auth.uid;
        }
        match /bricks/{docId} {
            allow create: if request.auth != null &amp;&amp; request.resource.data.userId == request.auth.uid;
        }
        match /notes/{goalId} {
            allow create: if request.auth != null &amp;&amp; request.resource.data.userId == request.auth.uid;
        }
        match /energyLog/{docId} {
            allow create: if request.auth != null &amp;&amp; request.resource.data.userId == request.auth.uid;
        }
        // Add create rule for new collections from v1.2 blueprint
        match /dailyLog/{docId} {
            allow create: if request.auth != null &amp;&amp; request.resource.data.userId == request.auth.uid;
        }
    }
}</code></pre>

                <hr>

                <h2>4. Application Modules (The "What")</h2>
                <p>The UI is a tabbed interface for a 3-step process:</p>
                
                <h3>Module 1: Authentication</h3>
                <ul>
                    <li><strong>UI:</strong> "Sign in with Google" button on loading screen; "Sign Out" button in header</li>
                    <li><strong>Logic:</strong> Uses Firebase Auth; On login, queries Firestore for user data</li>
                </ul>

                <h3>Module 2: "Comprehend" (Your Goals)</h3>
                <ul>
                    <li><strong>UI:</strong> "Project List" tab; Empty state message; Text box: <blockquote>"What's your 'One True Thing'?"</blockquote>; Button: <code>[ Alchemize (Create Goal) ]</code>; List of current goals (<code>isDeleted == false</code>) with <code>[Edit]</code> and <code>[Delete]</code> buttons</li>
                    <li><strong>Logic:</strong> "Alchemize" creates a new goal; List populated from goals collection; Clicking a goal makes it "active"</li>
                </ul>

                <h3>Module 3: "Deconstruct" (Your Workbench)</h3>
                <ul>
                    <li><strong>UI:</strong> Main "work" tab showing "Active Goal"</li>
                    <li><strong>Part 1: "Your One Brick"</strong>
                        <ul>
                            <li>Text box: <blockquote>"What's the absolute next physical step?"</blockquote></li>
                            <li>Button: <code>[ Add Brick ]</code></li>
                            <li>List of incomplete Bricks (<code>isDeleted == false</code>)</li>
                            <li>Each brick: <code>[ âœ“ ]</code> checkbox, <code>[Edit]</code>, <code>[Delete]</code></li>
                        </ul>
                    </li>
                    <li><strong>Part 2: "Brain Dump" (The Note Pad)</strong>
                        <ul>
                            <li>Large text area below "One Brick"</li>
                        </ul>
                    </li>
                    <li><strong>Logic:</strong> Adding a Brick creates a new document; Checking <code>[ âœ“ ]</code> updates <code>isComplete</code>; "Brain Dump" auto-saves to notes</li>
                </ul>

                <h3>Module 4: "Reconstruct" (Your Log)</h3>
                <ul>
                    <li><strong>UI:</strong> "Motivation" tab; Empty state if no completed bricks; Reverse-chronological list of completed Bricks (<code>isComplete == true</code>, <code>isDeleted == false</code>)</li>
                    <li><strong>Logic:</strong> Read-only query of bricks collection; Shows tangible proof of progress</li>
                </ul>

                <h3>Module 5: "Two-Front War" (Your Energy)</h3>
                <ul>
                    <li><strong>UI:</strong> "Energy" tab; Slider (Healing % vs. Building %); Button: <code>[ Log Today's Energy ]</code>; Empty state if no logs; Chart.js line chart of energy log history</li>
                    <li><strong>Logic:</strong> Button creates new energyLog document; Chart reads from energyLog collection</li>
                </ul>

                <hr>

                <h2>5. Data Structure (Firestore Collections)</h2>
                <p>How data is organized:</p>
                <ul>
                    <li><strong>goals/</strong><br><code>{goalId_A}: { userId: "...", title: "Start YouTube Channel", createdAt: ..., isDeleted: false }</code></li>
                    <li><strong>bricks/</strong><br><code>{brickId_A}: { userId: "...", goalId: "goalId_A", task: "Open phone camera", isComplete: false, createdAt: ..., isDeleted: false }</code><br><code>{brickId_B}: { userId: "...", goalId: "goalId_A", task: "Google 'free video software'", isComplete: true, completedAt: ..., isDeleted: false }</code></li>
                    <li><strong>notes/</strong> (Use goalId as document ID)<br><code>{goalId_A}: { userId: "...", content: "auto-saved brain dump text...", updatedAt: ... }</code></li>
                    <li><strong>energyLog/</strong><br><code>{logId_A}: { userId: "...", date: "2025-10-25", healing: 70, building: 30 }</code></li>
                    <li><strong>dailyLog/</strong> (For future v3.5)<br><code>{logId_A}: { userId: "...", date: "2025-10-25", mood: 4, note: "Good day, felt productive." }</code></li>
                </ul>

                <hr>

                <h2>6. Future Roadmap (The "v3" Plan)</h2>
                <p>Features postponed to ensure v2 is built correctly ("One-Brick" rule):</p>
                <ul>
                    <li><strong>v3.0: Project Sharing ("Friends List")</strong>
                        <ul><li>Share a goalId with another user by email</li><li>Requires new shares collection and complex security rules</li></ul>
                    </li>
                    <li><strong>v3.1: Advanced Statistics</strong>
                        <ul><li>"Stats" tab: Bricks completed per week, most productive day, etc.</li></ul>
                    </li>
                    <li><strong>v3.2: PWA (Progressive Web App)</strong>
                        <ul><li>Service worker and manifest for installable app-like experience</li></ul>
                    </li>
                    <li><strong>v3.3: Framework Migration (e.g., Next.js)</strong>
                        <ul><li>Move from single-file to full-stack framework for scalability and advanced features</li></ul>
                    </li>
                    <li><strong>v3.4: "Trash Can" (Recovery)</strong>
                        <ul><li>UI for viewing items with <code>isDeleted: true</code></li><li>Permanently delete or restore items</li></ul>
                    </li>
                    <li><strong>v3.5: "Daily Log / Mood Journal"</strong>
                        <ul><li>Simple journal for daily mood score (1â€“5) and note</li><li>Complements energyLog for qualitative self-reflection</li></ul>
                    </li>
                </ul>

            </article>
        </div>
    </main>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Page Toggling ---
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const btn1 = document.getElementById('btn-p1');
            const btn2 = document.getElementById('btn-p2');

            btn1.addEventListener('click', () => {
                page1.classList.remove('hidden');
                page2.classList.add('hidden');
                btn1.classList.add('active');
                btn2.classList.remove('active');
            });

            btn2.addEventListener('click', () => {
                page2.classList.remove('hidden');
                page1.classList.add('hidden');
                btn2.classList.add('active');
                btn1.classList.remove('active');
            });

            // --- Checklist & Progress Bar Logic ---
            const taskCheckboxes = document.querySelectorAll('.task-list .task-checkbox');
            const totalTasks = taskCheckboxes.length;
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const storageKey = 'tafgProjectProgress';

            // Load progress from localStorage
            function loadProgress() {
                const savedProgress = JSON.parse(localStorage.getItem(storageKey) || '{}');
                taskCheckboxes.forEach(checkbox => {
                    if (savedProgress[checkbox.id]) {
                        checkbox.checked = true;
                    }
                    // Add event listener for changes
                    checkbox.addEventListener('change', saveProgress);
                });
                updateProgress();
            }

            // Save progress to localStorage
            function saveProgress() {
                let savedProgress = {};
                taskCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        savedProgress[checkbox.id] = true;
                    }
                });
                localStorage.setItem(storageKey, JSON.stringify(savedProgress));
                updateProgress();
            }

            // Update the progress bar and text
            function updateProgress() {
                const checkedTasks = document.querySelectorAll('.task-list .task-checkbox:checked').length;
                const percentage = totalTasks > 0 ? (checkedTasks / totalTasks) * 100 : 0;
                
                progressBar.style.width = `${percentage}%`;
                progressText.textContent = `${checkedTasks} / ${totalTasks} tasks complete`;
            }

            // Initial load
            loadProgress();
        });
    </script>
</body>
</html>
